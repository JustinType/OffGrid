LED SETUP
ATTACKMODE HID STORAGE

# Check for switch position to make it easier for us.
GET SWITCH_POSITION

LED ATTACK

# Get OS from file os.txt
os=$(</root/udisk/payloads/${SWITCH_POSITION}/os.txt)

# Load script for windows or linux 
if [[ "$os" == "windows" ]]; then
	if [ -f "/root/udisk/payloads/${SWITCH_POSITION}/windows/script.txt" ]; then       	
		QUACK ${SWITCH_POSITION}/windows/script.txt
		LED FINISH
	else
    		LED FAIL
    		echo "Unable to load windows script.txt" >> /root/udisk/payloads/${SWITCH_POSITION}/debuglog.txt
        	exit 1
	fi
elif [[ "$os" == "linux" ]]; then
	if [ -f "/root/udisk/payloads/${SWITCH_POSITION}/linux/script.txt" ]; then 
		QUACK ${SWITCH_POSITION}/linux/debian.txt
		LED FINISH
	else
    		LED FAIL
    		echo "Unable to load linux script.txt" >> /root/udisk/payloads/${SWITCH_POSITION}/debuglog.txt
        	exit 1
	fi
else
	LED FAIL
    	echo "Unable to get os from file os.txt" >> /root/udisk/payloads/${SWITCH_POSITION}/debuglog.txt
        exit 1
fi
